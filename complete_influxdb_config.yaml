# Complete InfluxDB Configuration for Heating Analytics
# Add this to your main configuration.yaml file

# =============================================================================
# INFLUXDB CONFIGURATION - Add to configuration.yaml
# =============================================================================
influxdb:
  host: localhost  # Change to your InfluxDB host
  port: 8086
  database: homeassistant
  username: !secret influxdb_username  # Optional
  password: !secret influxdb_password  # Optional
  max_retries: 3
  default_measurement: state
  
  # Include only heating-related entities to keep database focused
  include:
    entities:
      # Core heating detection
      - binary_sensor.zone_one_heating_active
      - climate.castle_thermostat
      
      # Cycle tracking
      - counter.zone_one_heating_cycles_today
      - sensor.zone_one_heating_cycles_count_today
      
      # Duration tracking  
      - input_number.zone_one_total_heating_time_today
      - sensor.zone_one_heating_time_today
      - sensor.zone_one_average_heating_duration
      
      # Efficiency metrics
      - sensor.daily_heating_efficiency_zone_one
      - sensor.weekly_heating_efficiency
      - sensor.monthly_heating_cycles_average
      - sensor.monthly_average_heating_duration
      
      # Cost tracking
      - sensor.daily_heating_cost
      - sensor.monthly_heating_cost_projection
      - sensor.heating_efficiency_trend
      
      # Utility meters
      - sensor.daily_heating_time
      - sensor.monthly_heating_cycles
      - sensor.weekly_heating_efficiency_meter
      
      # Timing
      - input_datetime.zone_one_heating_start

# =============================================================================
# GRAFANA DASHBOARD QUERIES (Optional - for advanced users)
# =============================================================================
# Example InfluxDB queries you can use in Grafana:
#
# Heating cycles per day (last 30 days):
# SELECT mean("value") FROM "state" WHERE ("entity_id" = 'counter.zone_one_heating_cycles_today') AND time >= now() - 30d GROUP BY time(1d)
#
# Daily heating duration (last 7 days):  
# SELECT max("value") FROM "state" WHERE ("entity_id" = 'input_number.zone_one_total_heating_time_today') AND time >= now() - 7d GROUP BY time(1d)
#
# Heating efficiency trend (last 14 days):
# SELECT mean("value") FROM "state" WHERE ("entity_id" = 'sensor.daily_heating_efficiency_zone_one') AND time >= now() - 14d GROUP BY time(1d)
#
# Cost analysis (monthly):
# SELECT sum("value") FROM "state" WHERE ("entity_id" = 'sensor.daily_heating_cost') AND time >= now() - 30d GROUP BY time(1d)

# =============================================================================
# HOME ASSISTANT LONG-TERM STATISTICS  
# =============================================================================
# These entities will automatically be included in HA's long-term statistics:
recorder:
  purge_keep_days: 365  # Keep 1 year of detailed data
  
  # Include heating entities for long-term stats
  include:
    entities:
      - binary_sensor.zone_one_heating_active
      - counter.zone_one_heating_cycles_today
      - sensor.zone_one_average_heating_duration
      - sensor.daily_heating_efficiency_zone_one
      - sensor.daily_heating_cost
      - climate.castle_thermostat
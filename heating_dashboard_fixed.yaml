# Heating Cycle Dashboard Configuration
# Add this to your Lovelace dashboard or create a new dashboard

title: "ğŸ”¥ Zone ONE Heating Analytics"
icon: mdi:fire

views:
  - title: "Heating Analytics"
    path: "heating"
    icon: mdi:fire
    cards:
      # =============================================================================
      # DAILY HEATING OVERVIEW
      # =============================================================================
      - type: vertical-stack
        title: "Zone ONE Daily Overview"
        cards:
          # Current heating status
          - type: entity
            entity: binary_sensor.zone_one_heating_active
            name: "Zone ONE Heating Status"
            state_color: true
            icon: mdi:fire
          
          # Daily cycle count and statistics
          - type: horizontal-stack
            cards:
              - type: statistic
                entity: counter.zone_one_heating_cycles_today
                name: "Cycles Today"
                period: day
                stat_type: max
                
              - type: statistic
                entity: sensor.zone_one_average_heating_duration
                name: "Avg Duration"
                period: day
                stat_type: mean
                
              - type: statistic
                entity: sensor.daily_heating_efficiency_zone_one
                name: "Efficiency %"
                period: day
                stat_type: mean

      # =============================================================================
      # HEATING DURATION ANALYTICS
      # =============================================================================
      - type: vertical-stack
        title: "Zone ONE Duration Analytics"
        cards:
          # Total heating time today
          - type: horizontal-stack
            cards:
              - type: statistic
                entity: input_number.zone_one_total_heating_time_today
                name: "Total Time (min)"
                period: day
                stat_type: max
                
              - type: statistic
                entity: sensor.zone_one_heating_time_today
                name: "History Stats Time"
                period: day
                stat_type: sum
                
              - type: statistic
                entity: sensor.zone_one_heating_cycles_count_today
                name: "History Cycles"
                period: day
                stat_type: sum

      # =============================================================================
      # HEATING EFFICIENCY METRICS
      # =============================================================================
      - type: entities
        title: "ğŸ¯ Zone ONE Efficiency"
        entities:
          - entity: sensor.daily_heating_efficiency_zone_one
            name: "Zone ONE Efficiency"
            icon: mdi:speedometer
          - type: divider
          - entity: counter.zone_one_heating_cycles_today
            name: "Daily Cycles"
          - entity: input_number.zone_one_total_heating_time_today
            name: "Total Heating Time (min)"
          - entity: input_datetime.zone_one_heating_start
            name: "Last Heating Started"

      # =============================================================================
      # HISTORICAL CHARTS
      # =============================================================================
      - type: history-graph
        title: "ğŸ”¥ Zone ONE Heating Activity (24h)"
        entities:
          - binary_sensor.zone_one_heating_active
          - climate.castle_thermostat
        hours_to_show: 24
        refresh_interval: 300
        
      - type: history-graph
        title: "ğŸ“Š Zone ONE Daily Cycle Count (7 days)"
        entities:
          - counter.zone_one_heating_cycles_today
        hours_to_show: 168  # 7 days
        refresh_interval: 3600

      # =============================================================================
      # HEATING STATISTICS CARDS
      # =============================================================================
      - type: entities
        title: "ğŸ  Zone ONE Detailed Statistics"
        entities:
          - entity: counter.zone_one_heating_cycles_today
            name: "Heating Cycles Today"
          - entity: sensor.zone_one_average_heating_duration
            name: "Average Duration"
          - entity: input_number.zone_one_total_heating_time_today
            name: "Total Time (minutes)"
          - entity: input_datetime.zone_one_heating_start
            name: "Last Started"
          - type: divider
          - entity: climate.castle_thermostat
            name: "Climate Entity"
          - entity: binary_sensor.zone_one_heating_active
            name: "Heating Active"

      # =============================================================================
      # QUICK ACTION BUTTONS
      # =============================================================================
      - type: horizontal-stack
        title: "Quick Actions"
        cards:
          - type: button
            tap_action:
              action: call-service
              service: counter.reset
              service_data:
                entity_id: counter.zone_one_heating_cycles_today
            name: "Reset Cycle Counter"
            icon: mdi:refresh
            
          - type: button
            tap_action:
              action: call-service
              service: input_number.set_value
              service_data:
                entity_id: input_number.zone_one_total_heating_time_today
                value: 0
            name: "Reset Time Counter"
            icon: mdi:timer-outline
            
          - type: button
            tap_action:
              action: call-service
              service: homeassistant.update_entity
              service_data:
                entity_id: climate.castle_thermostat
            name: "Refresh Climate"
            icon: mdi:thermometer

      # =============================================================================
      # HEATING INSIGHTS CARD
      # =============================================================================
      - type: markdown
        title: "ğŸ’¡ Zone ONE Heating Insights"
        content: >
          ## Today's Zone ONE Heating Summary
          
          **Total Cycles:** {{ states('counter.zone_one_heating_cycles_today') }}
          
          **Total Runtime:** {{ (states('input_number.zone_one_total_heating_time_today') | float / 60) | round(1) }} hours
          
          **Average Duration:** {{ states('sensor.zone_one_average_heating_duration') }} minutes
          
          **Current Status:** {% if is_state('binary_sensor.zone_one_heating_active', 'on') %}ğŸ”¥ Heating{% else %}â„ï¸ Off{% endif %}
          
          **Efficiency Status:**
          {% set avg_duration = states('sensor.zone_one_average_heating_duration') | float %}
          {% if avg_duration < 10 %}âš ï¸ Short cycles - check insulation or thermostat placement
          {% elif avg_duration < 20 %}âœ… Normal efficiency
          {% else %}ğŸŒŸ Excellent efficiency - long cycles indicate good insulation{% endif %}
          
          **Daily Efficiency:** {{ states('sensor.daily_heating_efficiency_zone_one') }}%
          
          ---
          
          ### Zone ONE Quick Tips:
          - **Short cycles** (< 10 min): Poor insulation or oversized system
          - **Long cycles** (> 30 min): Good insulation, efficient heating
          - **Many cycles** (> 20/day): Check temperature settings
          - **Current temp:** {{ state_attr('climate.castle_thermostat', 'current_temperature') }}Â°C
          - **Target temp:** {{ state_attr('climate.castle_thermostat', 'temperature') }}Â°C
          
          *Last updated: {{ now().strftime('%H:%M') }}*

      # =============================================================================
      # COST ESTIMATION CARD
      # =============================================================================
      - type: entities
        title: "ğŸ’° Zone ONE Cost Estimation"
        entities:
          - entity: input_number.zone_one_total_heating_time_today
            name: "Daily Heating Time"
            secondary_info: "{{ (states('input_number.zone_one_total_heating_time_today') | float / 60) | round(1) }} hours"
          - type: section
          - entity: counter.zone_one_heating_cycles_today
            name: "Estimated Cost Today"
            secondary_info: >
              {% set hours = states('input_number.zone_one_total_heating_time_today') | float / 60 %}
              {% set kwh_per_hour = 3 %}
              {% set cost_per_kwh = 0.28 %}
              Â£{{ (hours * kwh_per_hour * cost_per_kwh) | round(2) }}
            icon: mdi:currency-gbp
          - entity: counter.zone_one_heating_cycles_today
            name: "Projected Monthly Cost"
            secondary_info: >
              {% set daily_cost = (states('input_number.zone_one_total_heating_time_today') | float / 60) * 3 * 0.28 %}
              Â£{{ (daily_cost * 30) | round(0) }}
            icon: mdi:calendar-month